<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 직장인 필수 툴 | 최장 연휴 시뮬레이터</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f4f4f4; padding: 20px; max-width: 960px; margin: auto; }
    select, button, input { padding: 10px; margin: 5px; border-radius: 6px; border: 1px solid #ccc; }
    .box { background: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); padding: 20px; margin-top: 20px; }
    .card { background: #fcfcfc; border-left: 5px solid #2ecc71; margin-bottom: 10px; padding: 15px; border-radius: 6px; }
    .copy-btn, .share-btn, .next-btn { margin-top: 10px; padding: 8px 12px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 5px; }
    .copy-btn:hover, .share-btn:hover, .next-btn:hover { background: #2c80b4; }
    table.calendar { width: 100%; border-collapse: collapse; margin-top: 10px; }
    table.calendar th, table.calendar td { width: 14%; border: 1px solid #ccc; padding: 8px; text-align: center; }
    .holiday { background-color: #FF6B6B; } /* 주말, 공휴일 */
    .leave { background-color: #4DA3FF; } /* 연차 사용 */
    .notice { font-size: 0.9em; color: #888; margin-bottom: 5px; }
  </style>
</head>
<body>
  <h1>2025 직장인 필수 툴 | 최장 연휴 시뮬레이터</h1>
  <p>공휴일과 주말을 조합하여 최장 연휴를 만드는 연차 전략을 추천합니다!</p>

  <div class="box">
    <label>연도:</label>
    <select id="year"></select>
    <label>월:</label>
    <select id="month"><option value="0">전체 연도</option></select>
    <label>연차 사용:</label>
    <select id="leaveDays">
      <option value="0">선택</option>
      <option value="1">1일</option>
      <option value="2">2일</option>
      <option value="3">3일</option>
    </select>
    <label>보유 연차:</label>
    <input type="number" id="totalLeave" value="15" min="1" max="30">
    <button onclick="prepareSuggestions()">계산하기</button>
  </div>

  <div class="box" id="resultBox"></div>

  <script>
    const yearSelect = document.getElementById("year");
    const monthSelect = document.getElementById("month");
    const leaveDaysSelect = document.getElementById("leaveDays");
    const totalLeaveInput = document.getElementById("totalLeave");
    const resultBox = document.getElementById("resultBox");

    let suggestions = [];
    let suggestionIndex = 0;

    const holidaysFixed = [
      "1/1",  // 신정
      "3/1",  // 삼일절
      "5/1",  // 근로자의날
      "5/5",  // 어린이날
      "6/6",  // 현충일
      "8/15", // 광복절
      "10/3", // 개천절
      "10/9", // 한글날
      "12/25" // 성탄절
    ];

    for (let y = 2024; y <= 2030; y++) {
      yearSelect.innerHTML += `<option value="${y}">${y}년</option>`;
    }
    for (let m = 1; m <= 12; m++) {
      monthSelect.innerHTML += `<option value="${m}">${m}월</option>`;
    }

    function prepareSuggestions() {
      resultBox.innerHTML = '';
      const year = parseInt(yearSelect.value);
      const month = parseInt(monthSelect.value);
      const leaveDays = parseInt(leaveDaysSelect.value);
      const totalLeave = parseInt(totalLeaveInput.value);

      suggestions = [];
      suggestionIndex = 0;

      let current = new Date(year, month > 0 ? month - 1 : 0, 1);
      const end = new Date(year, month > 0 ? month : 12, 0);

      while (current <= end) {
        if (current.getDay() === 0 || current.getDay() === 6) {
          const before = new Date(current);
          before.setDate(before.getDate() - leaveDays);
          suggestions.push({
            period: `${before.toLocaleDateString()} ~ ${current.toLocaleDateString()}`,
            totalDays: leaveDays + 2,
            requiredLeave: leaveDays,
            leaveStart: before,
            leaveEnd: current,
            usedLeave: leaveDays
          });
        }
        current.setDate(current.getDate() + 1);
      }

      suggestions = suggestions.filter(s => s.requiredLeave <= leaveDays && s.requiredLeave <= totalLeave);

      if (suggestions.length > 0) {
        showSuggestion();
      } else {
        resultBox.innerHTML = '<p>추천할 일정이 없습니다.</p>';
      }
    }

    function showSuggestion() {
      if (suggestionIndex >= suggestions.length) {
        resultBox.innerHTML = '<p>모든 추천 일정을 확인했습니다!</p>';
        return;
      }

      const s = suggestions[suggestionIndex];
      resultBox.innerHTML = `
        <div class="card">
          <b>추천 ${suggestionIndex + 1}:</b><br>
          📅 기간: ${s.period}<br>
          🛌 쉬는 일수: ${s.totalDays}일<br>
          📝 필요한 연차: ${s.requiredLeave}일<br>
          <button class="copy-btn" onclick="copyText('${s.period}')">복사하기</button>
          <button class="share-btn" onclick="shareText('${s.period}')">공유하기</button>
          <button class="next-btn" onclick="nextSuggestion()">다른 추천 보기</button>
          <div class="notice">※ 설날(구정)과 추석은 음력 명절로, 현재 달력에서는 별도 표기되지 않습니다.</div>
          ${drawCalendar(s)}
        </div>
      `;
    }

    function nextSuggestion() {
      suggestionIndex++;
      showSuggestion();
    }

    function copyText(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert('복사되었습니다!');
      });
    }

    function shareText(text) {
      if (navigator.share) {
        navigator.share({
          title: '연차 추천 공유',
          text: text,
          url: window.location.href
        });
      } else {
        alert('현재 브라우저는 공유를 지원하지 않습니다.');
      }
    }

    function drawCalendar(suggestion) {
      const year = suggestion.leaveStart.getFullYear();
      const month = suggestion.leaveStart.getMonth() + 1;
      const firstDay = new Date(year, month - 1, 1).getDay();
      const daysInMonth = new Date(year, month, 0).getDate();

      let html = '<table class="calendar"><tr><th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th></tr><tr>';
      let day = 1;
      for (let i = 0; i < firstDay; i++) html += '<td></td>';

      while (day <= daysInMonth) {
        if ((firstDay + day - 1) % 7 === 0) html += '</tr><tr>';
        const currentDate = new Date(year, month - 1, day);
        let dateString = `${currentDate.getMonth() + 1}/${currentDate.getDate()}`;

        let className = '';
        if (currentDate.getDay() === 0 || currentDate.getDay() === 6 || holidaysFixed.includes(dateString)) {
          className = 'holiday'; // 주말/공휴일 빨간색
        }
        if (currentDate >= suggestion.leaveStart && currentDate <= suggestion.leaveEnd) {
          if (!(currentDate.getDay() === 0 || currentDate.getDay() === 6 || holidaysFixed.includes(dateString))) {
            className = 'leave'; // 연차 사용은 파란색
          }
        }
        html += `<td class="${className}">${day}</td>`;
        day++;
      }
      html += '</tr></table>';
      return html;
    }
  </script>
</body>
</html>
